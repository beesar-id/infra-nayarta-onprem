# =============================================================================
# PostgreSQL Client Authentication Configuration File (pg_hba.conf)
# =============================================================================
# This file controls: which hosts are allowed to connect, how clients
# are authenticated, which PostgreSQL user names they can use, which
# databases they can access.
#
# All line endings are LF (Unix format) for cross-platform compatibility
# =============================================================================
#
# TYPE  DATABASE        USER            ADDRESS                 METHOD
#
# TYPE can be:
#   local     = Unix domain socket connections
#   host      = TCP/IP connections (both IPv4 and IPv6)
#   hostssl   = SSL-encrypted TCP/IP connections
#   hostnossl = Non-SSL TCP/IP connections
#
# DATABASE can be:
#   all       = All databases
#   sameuser  = Database with same name as user
#   samerole  = Database with same role as user
#   replication = Replication connections
#   <database> = Specific database name
#
# USER can be:
#   all       = All users
#   <user>    = Specific user name
#
# ADDRESS can be:
#   <ip>/<mask> = IP address with subnet mask
#   0.0.0.0/0   = All IPv4 addresses
#   ::/0        = All IPv6 addresses
#
# METHOD can be:
#   trust     = Allow connection without password (NOT RECOMMENDED for production)
#   reject    = Reject connection
#   md5       = Password authentication using MD5 hash
#   scram-sha-256 = Password authentication using SCRAM-SHA-256 (recommended)
#   password  = Password authentication in plain text (NOT RECOMMENDED)
#   ident     = Use OS username
#   peer      = Use OS username (Unix only)
#   cert      = SSL certificate authentication
#   pam       = PAM authentication
#   ldap      = LDAP authentication
# =============================================================================

# -----------------------------------------------------------------------------
# LOCAL CONNECTIONS (Unix Domain Socket)
# -----------------------------------------------------------------------------
# "local" is for Unix domain socket connections only
# Using trust for local connections (safe within container)
local   all             all                                     trust

# -----------------------------------------------------------------------------
# IPv4 LOCAL CONNECTIONS
# -----------------------------------------------------------------------------
# Localhost connections (127.0.0.1)
host    all             all             127.0.0.1/32            scram-sha-256

# All IPv4 addresses (0.0.0.0/0)
# WARNING: This allows connections from any IP address
# Consider restricting this in production environments
host    all             all             0.0.0.0/0               scram-sha-256

# -----------------------------------------------------------------------------
# IPv6 LOCAL CONNECTIONS
# -----------------------------------------------------------------------------
# IPv6 localhost connections (::1)
host    all             all             ::1/128                 scram-sha-256

# -----------------------------------------------------------------------------
# REPLICATION CONNECTIONS
# -----------------------------------------------------------------------------
# Allow replication connections from localhost
# Users must have REPLICATION privilege
local   replication     all                                     trust
host    replication     all             127.0.0.1/32            scram-sha-256
host    replication     all             ::1/128                 scram-sha-256

# -----------------------------------------------------------------------------
# DOCKER NETWORK CONNECTIONS
# -----------------------------------------------------------------------------
# Allow connections from Docker networks
# These are common Docker network ranges
host    all             all             172.16.0.0/12           scram-sha-256
host    all             all             192.168.0.0/16          scram-sha-256
host    all             all             10.0.0.0/8              scram-sha-256

# -----------------------------------------------------------------------------
# REPLICATION FROM DOCKER NETWORKS
# -----------------------------------------------------------------------------
# Allow replication from Docker networks (if needed)
host    replication     all             172.16.0.0/12           scram-sha-256
host    replication     all             192.168.0.0/16          scram-sha-256
host    replication     all             10.0.0.0/8              scram-sha-256

# =============================================================================
# END OF CONFIGURATION
# =============================================================================
